<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:flowable="http://flowable.org/bpmn"
             targetNamespace="http://www.flowable.org/processdef">

  <process id="expense-approval" name="Expense Approval" isExecutable="true">
    <startEvent id="startEvent" flowable:formFieldValidation="true" />
    <sequenceFlow sourceRef="startEvent" targetRef="supervisorApproval" />

    <userTask id="supervisorApproval" name="Supervisor Approval" flowable:candidateGroups="SUPERVISOR">
      <documentation>Review expense request for ${amount}</documentation>
    </userTask>
    <sequenceFlow sourceRef="supervisorApproval" targetRef="amountCheckGateway" />

    <exclusiveGateway id="amountCheckGateway" />
    <sequenceFlow sourceRef="amountCheckGateway" targetRef="executiveApproval">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${amount > 500}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow sourceRef="amountCheckGateway" targetRef="endEvent">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${amount <= 500}]]></conditionExpression>
    </sequenceFlow>

    <userTask id="executiveApproval" name="Executive Approval" flowable:candidateGroups="EXECUTIVE">
       <documentation>Executive review for high value expense ${amount}</documentation>
    </userTask>
    <sequenceFlow sourceRef="executiveApproval" targetRef="endEvent" />

    <endEvent id="endEvent" />
  </process>
</definitions>
